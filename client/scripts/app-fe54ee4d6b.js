!function(){"use strict";angular.module("wrlUi.security",["ngResource"])}(),function(){"use strict";function t(t,e){function r(){return t.logout().$promise.then(function(){s()})}function n(e,r){return t.create({email:e,password:r}).$promise}function o(e,r){return t.login({email:e,password:r}).$promise.then(function(t){s(t)})}function s(t){a.isAuthenticated=!!t,a.user=t?t.user:{},a.tokenId=t?t.id:""}var a={};return s(),{authentication:a,login:o,logOut:r,signUp:n}}t.$inject=["Agent","$rootScope"],angular.module("wrlUi.security").factory("authService",t)}(),function(){"use strict";function t(t,e,r){function n(n){return 401===n.status&&"AUTHORIZATION_REQUIRED"==n.data.error.code&&r.warning("Вы не авторизованы для выполнения этой операции и будете направлены на страницу логина!",{timeOut:3e3,progressBar:!0,onHidden:function(){e.path("/login")}}),t.reject(n)}var o={responseError:n};return o}t.$inject=["$q","$location","toastr"],angular.module("wrlUi.security").factory("authInterceptionService",t)}(),function(){"use strict";function t(t,e,r){function n(){var t=e(function(){e.cancel(t),r.go("login")},2e3)}var o=this;o.savedSuccessfully=!1,o.message="",o.registration={email:"",password:"",confirmPassword:""},o.signUp=function(){t.signUp(o.registration.email,o.registration.password).then(function(t){o.savedSuccessfully=!0,o.message="Пользователь успешно зарегистрирован, вы будете направлены на страницу логина через 2 секунды.",n()},function(t){})}}t.$inject=["authService","$timeout","$state"],angular.module("wrlUi.security").controller("SignupController",t)}(),function(){"use strict";function t(t,e,r,n){var o=this;o.message="",o.loginData={email:"",password:""},o.login=function(){t.login(o.loginData.email,o.loginData.password).then(function(){r.$emit("Event::UserLoggedIn"),e.go("apartments")},function(t){n.error("<strong>Ошибка авторизации!</strong> Email пользователя и/или пароль не верны. <br />Введите корректные данные.",{})})}}t.$inject=["authService","$state","$rootScope","toastr"],angular.module("wrlUi.security").controller("LoginController",t)}(),function(){"use strict";angular.module("wrlUi.apartments",["ui.grid","ui.grid.resizeColumns","snap"]).config(["snapRemoteProvider",function(t){t.globalOptions={disable:"right"}}])}(),function(){"use strict";function t(t){function e(){return t.query().$promise}function r(e){return t.save(e).$promise}function n(e){return t.find({filter:{where:{streetName:e.streetName}}}).$promise}return{getApartments:e,createApartment:r,findApartments:n}}t.$inject=["Apartment"],angular.module("wrlUi.apartments").factory("apartmentsService",t)}(),function(){"use strict";function t(t,e,r){var n=this;n.lang=e.langLocale,n.searchBy={streetName:""},n.gridOptions={columnDefs:[{name:"Номер",field:"number"},{name:"Название улицы",field:"streetName"},{name:"№ дома",field:"houseNumber"}]},t.getApartments().then(function(t){n.gridOptions.data=t}),n.editApartment=function(t){var e=r.open({animation:!0,templateUrl:"app/components/apartments/templates/apartmentDetails.html",controller:"ApartmentDetailsController",controllerAs:"vm",resolve:{apartment:t}});e.result.then(function(t){n.gridOptions.data.push(t)},function(){})},n.findApartments=function(){t.findApartments(n.searchBy).then(function(t){n.gridOptions.data=t})}}t.$inject=["apartmentsService","settings","$uibModal"],angular.module("wrlUi.apartments").controller("ApartmentsController",t)}(),function(){var t=function(t,e){var r=this;r.save=function(){t.createApartment(r.apartment).then(function(t){e.close(t)},function(t){})},r.cancel=function(){e.dismiss("cancel")},r.newApartment=function(){return{number:"testNumber"}},r.apartment=r.newApartment()};t.$inject=["apartmentsService","$uibModalInstance"],angular.module("wrlUi.apartments").controller("ApartmentDetailsController",t)}(),function(){"use strict";angular.module("wrlUi",["ui.router","ui.bootstrap","wrlUi.security","wrlUi.apartments","toastr","lbServices","LocalStorageModule"])}(),function(){"use strict";function t(){function t(t,e,r){var n=this;n.logOut=function(){t.logOut().then(function(){n.setAuthData(),r.go("home")})},n.setAuthData=function(){n.isAuthenticated=t.authentication.isAuthenticated,n.userEmail=t.authentication.user.email},n.setAuthData(),e.$on("Event::UserLoggedIn",function(t){t.preventDefault(),t.stopPropagation(),n.setAuthData()})}t.$inject=["authService","$rootScope","$state"];var e={restrict:"E",templateUrl:"app/components/navbar/navbar.html",scope:!1,controller:t,controllerAs:"vm",bindToController:!0};return e}angular.module("wrlUi").directive("wrlNavbar",t)}(),function(){"use strict";function t(t){function e(e,r,n,o){var s,a=t(r[0],{typeSpeed:40,deleteSpeed:40,pauseDelay:800,loop:!0,postfix:" "});r.addClass("acme-malarkey"),angular.forEach(e.extraValues,function(t){a.type(t).pause()["delete"]()}),s=e.$watch("vm.contributors",function(){angular.forEach(o.contributors,function(t){a.type(t.login).pause()["delete"]()})}),e.$on("$destroy",function(){s()})}function r(t,e){function r(){return n().then(function(){t.info("Activated Contributors View")})}function n(){return e.getContributors(10).then(function(t){return o.contributors=t,o.contributors})}var o=this;o.contributors=[],r()}r.$inject=["$log","githubContributor"];var n={restrict:"E",scope:{extraValues:"="},template:"&nbsp;",link:e,controller:r,controllerAs:"vm"};return n}t.$inject=["malarkey"],angular.module("wrlUi").directive("acmeMalarkey",t)}(),function(){"use strict";function t(t,e){function r(r){function o(t){return t.data}function s(e){t.error("XHR Failed for getContributors.\n"+angular.toJson(e.data,!0))}return r||(r=30),e.get(n+"/contributors?per_page="+r).then(o)["catch"](s)}var n="https://api.github.com/repos/Swiip/generator-gulp-angular",o={apiHost:n,getContributors:r};return o}t.$inject=["$log","$http"],angular.module("wrlUi").factory("githubContributor",t)}(),function(t,e,r){"use strict";function n(t){var e=t.match(/^(?:https?:)?\/\/([^\/]+)/);return e?e[1]:null}var o="http://localhost:3001/api",s="authorization",a=n(o)||location.host,i=e.module("lbServices",["ngResource"]);i.factory("User",["LoopBackResource","LoopBackAuth","$injector",function(t,e,r){var n=t(o+"/Users/:id",{id:"@id"},{prototype$__findById__accessTokens:{params:{fk:"@fk"},url:o+"/Users/:id/accessTokens/:fk",method:"GET"},prototype$__destroyById__accessTokens:{params:{fk:"@fk"},url:o+"/Users/:id/accessTokens/:fk",method:"DELETE"},prototype$__updateById__accessTokens:{params:{fk:"@fk"},url:o+"/Users/:id/accessTokens/:fk",method:"PUT"},prototype$__get__accessTokens:{isArray:!0,url:o+"/Users/:id/accessTokens",method:"GET"},prototype$__create__accessTokens:{url:o+"/Users/:id/accessTokens",method:"POST"},prototype$__delete__accessTokens:{url:o+"/Users/:id/accessTokens",method:"DELETE"},prototype$__count__accessTokens:{url:o+"/Users/:id/accessTokens/count",method:"GET"},create:{url:o+"/Users",method:"POST"},createMany:{isArray:!0,url:o+"/Users",method:"POST"},upsert:{url:o+"/Users",method:"PUT"},exists:{url:o+"/Users/:id/exists",method:"GET"},findById:{url:o+"/Users/:id",method:"GET"},find:{isArray:!0,url:o+"/Users",method:"GET"},findOne:{url:o+"/Users/findOne",method:"GET"},updateAll:{url:o+"/Users/update",method:"POST"},deleteById:{url:o+"/Users/:id",method:"DELETE"},count:{url:o+"/Users/count",method:"GET"},prototype$updateAttributes:{url:o+"/Users/:id",method:"PUT"},createChangeStream:{url:o+"/Users/change-stream",method:"POST"},login:{params:{include:"user"},interceptor:{response:function(t){var r=t.data;return e.setUser(r.id,r.userId,r.user),e.rememberMe=t.config.params.rememberMe!==!1,e.save(),t.resource}},url:o+"/Users/login",method:"POST"},logout:{interceptor:{response:function(t){return e.clearUser(),e.clearStorage(),t.resource}},url:o+"/Users/logout",method:"POST"},confirm:{url:o+"/Users/confirm",method:"GET"},resetPassword:{url:o+"/Users/reset",method:"POST"},getCurrent:{url:o+"/Users/:id",method:"GET",params:{id:function(){var t=e.currentUserId;return null==t&&(t="__anonymous__"),t}},interceptor:{response:function(t){return e.currentUserData=t.data,t.resource}},__isGetCurrentUser__:!0}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.getCachedCurrent=function(){var t=e.currentUserData;return t?new n(t):null},n.isAuthenticated=function(){return null!=this.getCurrentId()},n.getCurrentId=function(){return e.currentUserId},n.modelName="User",n}]),i.factory("Apartment",["LoopBackResource","LoopBackAuth","$injector",function(t,e,r){var n=t(o+"/apartments/:id",{id:"@id"},{create:{url:o+"/apartments",method:"POST"},createMany:{isArray:!0,url:o+"/apartments",method:"POST"},upsert:{url:o+"/apartments",method:"PUT"},exists:{url:o+"/apartments/:id/exists",method:"GET"},findById:{url:o+"/apartments/:id",method:"GET"},find:{isArray:!0,url:o+"/apartments",method:"GET"},findOne:{url:o+"/apartments/findOne",method:"GET"},updateAll:{url:o+"/apartments/update",method:"POST"},deleteById:{url:o+"/apartments/:id",method:"DELETE"},count:{url:o+"/apartments/count",method:"GET"},prototype$updateAttributes:{url:o+"/apartments/:id",method:"PUT"},createChangeStream:{url:o+"/apartments/change-stream",method:"POST"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="Apartment",n}]),i.factory("Agent",["LoopBackResource","LoopBackAuth","$injector",function(t,e,r){var n=t(o+"/agents/:id",{id:"@id"},{prototype$__findById__accessTokens:{params:{fk:"@fk"},url:o+"/agents/:id/accessTokens/:fk",method:"GET"},prototype$__destroyById__accessTokens:{params:{fk:"@fk"},url:o+"/agents/:id/accessTokens/:fk",method:"DELETE"},prototype$__updateById__accessTokens:{params:{fk:"@fk"},url:o+"/agents/:id/accessTokens/:fk",method:"PUT"},prototype$__get__accessTokens:{isArray:!0,url:o+"/agents/:id/accessTokens",method:"GET"},prototype$__create__accessTokens:{url:o+"/agents/:id/accessTokens",method:"POST"},prototype$__delete__accessTokens:{url:o+"/agents/:id/accessTokens",method:"DELETE"},prototype$__count__accessTokens:{url:o+"/agents/:id/accessTokens/count",method:"GET"},create:{url:o+"/agents",method:"POST"},createMany:{isArray:!0,url:o+"/agents",method:"POST"},upsert:{url:o+"/agents",method:"PUT"},exists:{url:o+"/agents/:id/exists",method:"GET"},findById:{url:o+"/agents/:id",method:"GET"},find:{isArray:!0,url:o+"/agents",method:"GET"},findOne:{url:o+"/agents/findOne",method:"GET"},updateAll:{url:o+"/agents/update",method:"POST"},deleteById:{url:o+"/agents/:id",method:"DELETE"},count:{url:o+"/agents/count",method:"GET"},prototype$updateAttributes:{url:o+"/agents/:id",method:"PUT"},createChangeStream:{url:o+"/agents/change-stream",method:"POST"},login:{params:{include:"user"},interceptor:{response:function(t){var r=t.data;return e.setUser(r.id,r.userId,r.user),e.rememberMe=t.config.params.rememberMe!==!1,e.save(),t.resource}},url:o+"/agents/login",method:"POST"},logout:{interceptor:{response:function(t){return e.clearUser(),e.clearStorage(),t.resource}},url:o+"/agents/logout",method:"POST"},confirm:{url:o+"/agents/confirm",method:"GET"},resetPassword:{url:o+"/agents/reset",method:"POST"},getCurrent:{url:o+"/agents/:id",method:"GET",params:{id:function(){var t=e.currentUserId;return null==t&&(t="__anonymous__"),t}},interceptor:{response:function(t){return e.currentUserData=t.data,t.resource}},__isGetCurrentUser__:!0}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.getCachedCurrent=function(){var t=e.currentUserData;return t?new n(t):null},n.isAuthenticated=function(){return null!=this.getCurrentId()},n.getCurrentId=function(){return e.currentUserId},n.modelName="Agent",n}]),i.factory("LoopBackAuth",function(){function t(){var t=this;n.forEach(function(e){t[e]=r(e)}),this.currentUserData=null}function e(t,e,r){var n=o+e;null==r&&(r=""),t[n]=r}function r(t){var e=o+t;return localStorage[e]||sessionStorage[e]||null}var n=["accessTokenId","currentUserId","rememberMe"],o="$LoopBack$";return t.prototype.save=function(){var t=this,r=this.rememberMe?localStorage:sessionStorage;n.forEach(function(n){e(r,n,t[n])})},t.prototype.setUser=function(t,e,r){this.accessTokenId=t,this.currentUserId=e,this.currentUserData=r},t.prototype.clearUser=function(){this.accessTokenId=null,this.currentUserId=null,this.currentUserData=null},t.prototype.clearStorage=function(){n.forEach(function(t){e(sessionStorage,t,null),e(localStorage,t,null)})},new t}).config(["$httpProvider",function(t){t.interceptors.push("LoopBackAuthRequestInterceptor")}]).factory("LoopBackAuthRequestInterceptor",["$q","LoopBackAuth",function(t,e){return{request:function(o){var i=n(o.url);if(i&&i!==a)return o;if(e.accessTokenId)o.headers[s]=e.accessTokenId;else if(o.__isGetCurrentUser__){var l={body:{error:{status:401}},status:401,config:o,headers:function(){return r}};return t.reject(l)}return o||t.when(o)}}}]).provider("LoopBackResource",function(){this.setAuthHeader=function(t){s=t},this.setUrlBase=function(t){o=t,a=n(o)||location.host},this.getUrlBase=function(){return o},this.$get=["$resource",function(t){return function(e,r,n){var o=t(e,r,n);return o.prototype.$save=function(t,e){var r=o.upsert.call(this,{},this,t,e);return r.$promise||r},o}}]})}(window,window.angular),function(){"use strict";function t(){function t(){}var e={restrict:"E",templateUrl:"app/components/footer/footer.html",scope:{},controller:t,controllerAs:"vm",bindToController:!0};return e}angular.module("wrlUi").directive("wrlFooter",t)}(),function(){"use strict";function t(){}angular.module("wrlUi").controller("MainController",t)}(),function(){"use strict";function t(t){t.debug("runBlock end")}t.$inject=["$log"],angular.module("wrlUi").run(t)}(),function(){"use strict";function t(t,e){t.state("home",{url:"/",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"main"}).state("login",{url:"/login",templateUrl:"app/components/security/templates/login.html",controller:"LoginController",controllerAs:"vm"}).state("signup",{url:"/signup",templateUrl:"app/components/security/templates/signup.html",controller:"SignupController",controllerAs:"vm"}).state("apartments",{url:"/apartments",templateUrl:"app/components/apartments/templates/apartmentsList.html",controller:"ApartmentsController",controllerAs:"vm"}),e.otherwise("/")}t.$inject=["$stateProvider","$urlRouterProvider"],angular.module("wrlUi").config(t)}(),function(){"use strict";angular.module("wrlUi").constant("malarkey",malarkey).constant("moment",moment).service("settings",function(){return{baseApiUrl:"http://localhost:3001/api/",langLocale:"ru"}})}(),function(){"use strict";function t(t,e,r,n,o){t.debugEnabled(!0),e.allowHtml=!0,e.timeOut=3e3,e.positionClass="toast-top-right",e.preventDuplicates=!0,e.progressBar=!0,r.setUrlBase("http://localhost:3001/api"),n.setPrefix("wrl"),o.interceptors.push("authInterceptionService")}t.$inject=["$logProvider","toastrConfig","LoopBackResourceProvider","localStorageServiceProvider","$httpProvider"],angular.module("wrlUi").config(t)}(),angular.module("wrlUi").run(["$templateCache",function(t){t.put("app/main/main.html",'<div class="container"><div class="row"></div><div class="row jumbotron text-center"><h1>Web Realty Life</h1></div><div class="row"><div class="col-lg-6"><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title">Вход</h3></div><div class="panel-body">Чтобы начать пользоваться системой необходимо войти в систему под своей учетной записью. Если у Вас еще нет учетной записи, воспользуйтесь инструкцией в блоке Регистрация. Для входа в систему нажмите в правом верхнем углу ссылку с названием "Вход", или нажмите кнопку "Вход" ниже в этом блоке.<div><button type="button" class="btn btn-primary full-container-width">Вход</button></div></div></div></div><div class="col-lg-6"><div class="panel panel-success"><div class="panel-heading"><h3 class="panel-title">Регистрация</h3></div><div class="panel-body">Для того чтобы воспользоваться приватной частью системы небоходимо пройти регистрацию. Для этого Вам необходимо в правом верхнем углу нажать на ссылку с названием "Регистрация", или нажать на кнопку "Регистрация" ниже в этом блоке.<div><button type="button" class="btn btn-success full-container-width">Регистрация</button></div></div></div></div></div></div>'),t.put("app/components/footer/footer.html",'<div class="panel-footer navbar-fixed-bottom"><div class="container"><p class="text-muted">Разработано: Nick Colipso.</p></div></div>'),t.put("app/components/navbar/navbar.html",'<div class="navbar navbar-default navbar-static-top" role="navigation"><div class="container"><div class="navbar-header"><a class="navbar-brand" ui-sref="home">Домашняя</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right"><li ng-hide="!vm.isAuthenticated"><a><span ng-bind="\'Добро пожаловать \' + vm.userEmail"></span></a></li><li ng-hide="!vm.isAuthenticated"><a ui-sref="apartments">Квартиры</a></li><li ng-hide="!vm.isAuthenticated"><a ng-click="vm.logOut()">Выйти</a></li><li ng-hide="vm.isAuthenticated"><a ui-sref="login">Войти</a></li><li ng-hide="vm.isAuthenticated"><a ui-sref="signup">Регистрация</a></li></ul></div></div></div>'),t.put("app/components/apartments/templates/apartmentDetails.html",'<div id="apartment-edit-form"><div class="modal-header"><h3 class="modal-title">Новая квартира</h3></div><div class="modal-body"><form><div class="form-group"><label for="streetName">Название улицы</label> <input ng-model="vm.apartment.streetName" type="text" class="form-control" id="streetName" placeholder="Название улицы"></div><div class="form-group"><label for="houseNumber">Номер дома</label> <input ng-model="vm.apartment.houseNumber" type="text" class="form-control" id="houseNumber" placeholder="Номер дома"></div></form></div><div class="modal-footer"><button class="btn btn-primary" type="button" ng-click="vm.save()">Сохранить</button> <button class="btn btn-warning" type="button" ng-click="vm.cancel()">Отмена</button></div></div>'),t.put("app/components/apartments/templates/apartmentsList.html",'<div id="menu-trigger" snap-toggle="left" title="Показать/скрыть Меню"><i class="glyphicon glyphicon-menu-hamburger"></i></div><snap-drawer id="side-menu"><div class="panel panel-default"><div class="panel-heading"><h4>Меню</h4></div><div class="panel-body"><uib-accordion close-others="true"><uib-accordion-group heading="Элементы"><div class="list-group"><button ng-click="vm.editApartment()" class="list-group-item"><span class="glyphicon glyphicon-home"></span> Добавить квартиру</button> <button ng-click="" class="list-group-item"><span class="glyphicon glyphicon-plus"></span> В разработке</button> <button ng-click="" class="list-group-item"><span class="glyphicon glyphicon-plus"></span> В разработке</button> <button ng-click="" class="list-group-item"><span class="glyphicon glyphicon-plus"></span> В разработке</button></div></uib-accordion-group><uib-accordion-group heading="Поиск"><input type="text" class="form-control" ng-change="vm.findApartments()" ng-model-options="{ debounce: 1000 }" ng-model="vm.searchBy.streetName"></uib-accordion-group></uib-accordion></div></div></snap-drawer><snap-content snap-content="" class="container-fluid" ui-i18n="{{vm.lang}}"><div snap-ignore="true" ui-grid="vm.gridOptions" class="myGrid" ui-grid-resize-columns=""></div></snap-content>'),t.put("app/components/security/templates/login.html",'<div class="container"><div class="row"><div class="col-lg-8 alert alert-dismissible alert-danger" ng-show="vm.message.length > 0"><button type="button" class="close" data-dismiss="alert">×</button> <strong>Вход не выполнен!</strong><p ng-bind="vm.message"></p></div><div class="col-lg-8"><div class="well"><form class="form-horizontal" role="form"><fieldset><legend>Введите свои данные для входа</legend><div class="form-group"><label for="inputName" class="col-lg-3 control-label">Логин</label><div class="col-lg-9"><input type="text" class="form-control" id="inputName" ng-model="vm.loginData.email" placeholder="Имя Пользователя"></div></div><div class="form-group"><label for="inputPassword" class="col-lg-3 control-label">Пароль</label><div class="col-lg-9"><input type="password" class="form-control" id="inputPassword" ng-model="vm.loginData.password" placeholder="Пароль"></div></div><div class="form-group"><div class="col-lg-9 col-lg-offset-3"><button type="submit" class="btn btn-primary" ng-click="vm.login()">Войти</button> <button type="reset" class="btn btn-warning">Отмена</button></div></div></fieldset></form></div></div></div></div>'),t.put("app/components/security/templates/signup.html",'<div class="container"><div class="row"><div class="col-lg-8 alert alert-dismissible alert-danger" ng-show="vm.message.length > 0"><button type="button" class="close" data-dismiss="alert">×</button> <strong>Регистрация не завершена!</strong><p ng-bind="vm.message"></p></div><div class="col-lg-8"><div class="well"><form class="form-horizontal" role="form"><fieldset><legend>Введите свои данные для регистрации</legend><div class="form-group"><label for="inputEmail" class="col-lg-3 control-label">Логин</label><div class="col-lg-9"><input type="text" class="form-control" id="inputEmail" ng-model="vm.registration.email" placeholder="Email Пользователя"></div></div><div class="form-group"><label for="inputPassword" class="col-lg-3 control-label">Пароль</label><div class="col-lg-9"><input type="password" class="form-control" id="inputPassword" ng-model="vm.registration.password" placeholder="Пароль"></div></div><div class="form-group"><label for="inputRepeatPassword" class="col-lg-3 control-label">Повторите Пароль</label><div class="col-lg-9"><input type="password" class="form-control" id="inputRepeatPassword" ng-model="vm.registration.confirmPassword" placeholder="Введите Пароль еще раз"></div></div><div class="form-group"><div class="col-lg-9 col-lg-offset-3"><button type="submit" class="btn btn-primary" ng-click="vm.signUp()">Регистрация</button> <button type="reset" class="btn btn-warning">Отмена</button></div></div></fieldset></form></div></div></div></div>')}]);
//# sourceMappingURL=../maps/scripts/app-fe54ee4d6b.js.map
